{"version":3,"file":"store-lib.mjs","sources":["../../../projects/store-lib/src/lib/models/course.ts","../../../projects/store-lib/src/lib/store-lib.service.ts","../../../projects/store-lib/src/lib/store-lib.component.ts","../../../projects/store-lib/src/lib/store-lib.module.ts","../../../projects/store-lib/src/lib/store-auth-lib.service.ts","../../../projects/store-lib/src/public-api.ts","../../../projects/store-lib/src/store-lib.ts"],"sourcesContent":["export interface Course {\n  id: string;\n  description: string;\n  longDescription: string;\n  seqNo: number;\n  iconUrl: string;\n  price: number;\n  uploadedImageUrl: string;\n  courseListIcon: string;\n  category: string;\n  lessonsCount: number;\n}\n\nexport interface IResponse {\n  payload: Course[];\n}\n\nexport function sortCoursesBySeqNo(c1: Course, c2: Course) {\n  return c1.seqNo - c2.seqNo;\n}\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { LoadingService, MessagesService } from '@commons-lib';\nimport {\n  BehaviorSubject,\n  catchError,\n  map,\n  Observable,\n  shareReplay,\n  tap,\n  throwError,\n} from 'rxjs';\nimport { Course, IResponse, sortCoursesBySeqNo } from './models/course';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class StoreLibService {\n  private subject = new BehaviorSubject<Course[]>([]);\n\n  public courses$: Observable<Course[]> = this.subject.asObservable();\n\n  constructor(\n    private http: HttpClient,\n    private loading: LoadingService,\n    private messages: MessagesService\n  ) {\n    this.loadAllCourses();\n  }\n\n  private loadAllCourses() {\n    const loadCourses$ = this.http.get<IResponse>('/api/courses').pipe(\n      map((response) => response.payload),\n      catchError((err) => {\n        const message = 'Could not load courses';\n        this.messages.showErrors(message);\n        console.log(message, err);\n        return throwError(() => err);\n      }),\n      tap((courses) => this.subject.next(courses))\n    );\n\n    this.loading.showLoaderUntilCompleted(loadCourses$).subscribe();\n  }\n\n  public saveCourse(courseId: string, changes: Partial<Course>): Observable<any> {\n    const courses = this.subject.getValue();\n\n    const index = courses.findIndex((course) => course.id == courseId);\n\n    const newCourse: Course = {\n      ...courses[index],\n      ...changes,\n    };\n\n    const newCourses: Course[] = courses.slice(0);\n\n    newCourses[index] = newCourse;\n\n    this.subject.next(newCourses);\n\n    return this.http.put(`/api/courses/${courseId}`, changes).pipe(\n      catchError((err) => {\n        const message = 'Could not save course';\n        console.log(message, err);\n        this.messages.showErrors(message);\n        return throwError(() => err);\n      }),\n      shareReplay()\n    );\n  }\n\n  public filterByCategory(category: string): Observable<Course[]> {\n    return this.courses$.pipe(\n      map((courses) =>\n        courses\n          .filter((course) => course.category == category)\n          .sort(sortCoursesBySeqNo)\n      )\n    );\n  }\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'lib-store-lib',\n  template: `\n    <p>\n      store-lib works!\n    </p>\n  `,\n  styles: [\n  ]\n})\nexport class StoreLibComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { CommonsLibModule } from '@commons-lib';\nimport { StoreLibComponent } from './store-lib.component';\n\n@NgModule({\n  declarations: [StoreLibComponent],\n  imports: [CommonModule, CommonsLibModule],\n  exports: [StoreLibComponent],\n})\nexport class StoreLibModule {}\n","import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { BehaviorSubject, map, Observable, shareReplay, tap } from 'rxjs';\nimport { User } from './models/user';\n\nconst AUTH_DATA = 'auth_data';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class StoreAuthLibService {\n  private subject = new BehaviorSubject<User | null>(null);\n\n  public user$: Observable<User | null> = this.subject.asObservable();\n\n  public isLoggedIn$!: Observable<boolean>;\n  public isLoggedOut$!: Observable<boolean>;\n\n  constructor(private http: HttpClient) {\n    this.isLoggedIn$ = this.user$.pipe(map((user) => !!user));\n\n    this.isLoggedOut$ = this.isLoggedIn$.pipe(map((loggedIn) => !loggedIn));\n\n    const user = localStorage.getItem(AUTH_DATA);\n\n    if (user) {\n      this.subject.next(JSON.parse(user));\n    }\n  }\n\n  public login(email: string, password: string): Observable<User> {\n    return this.http.post<User>('/api/login', { email, password }).pipe(\n      tap((user) => {\n        this.subject.next(user);\n        localStorage.setItem(AUTH_DATA, JSON.stringify(user));\n      }),\n      shareReplay()\n    );\n  }\n\n  public logout() {\n    this.subject.next(null);\n    localStorage.removeItem(AUTH_DATA);\n  }\n}\n","/*\n * Public API Surface of store-lib\n */\n\nexport * from './lib/store-lib.service';\nexport * from './lib/store-lib.component';\nexport * from './lib/store-lib.module';\nexport * from './lib/store-auth-lib.service';\nexport * from './lib/models/course';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":";;;;;;;;AAiBgB,SAAA,kBAAkB,CAAC,EAAU,EAAE,EAAU,EAAA;AACvD,IAAA,OAAO,EAAE,CAAC,KAAK,GAAG,EAAE,CAAC,KAAK,CAAC;AAC7B;;MCFa,eAAe,CAAA;AAK1B,IAAA,WAAA,CACU,IAAgB,EAChB,OAAuB,EACvB,QAAyB,EAAA;QAFzB,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAY;QAChB,IAAO,CAAA,OAAA,GAAP,OAAO,CAAgB;QACvB,IAAQ,CAAA,QAAA,GAAR,QAAQ,CAAiB;AAP3B,QAAA,IAAA,CAAA,OAAO,GAAG,IAAI,eAAe,CAAW,EAAE,CAAC,CAAC;AAE7C,QAAA,IAAA,CAAA,QAAQ,GAAyB,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC;QAOlE,IAAI,CAAC,cAAc,EAAE,CAAC;KACvB;IAEO,cAAc,GAAA;AACpB,QAAA,MAAM,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAY,cAAc,CAAC,CAAC,IAAI,CAChE,GAAG,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,OAAO,CAAC,EACnC,UAAU,CAAC,CAAC,GAAG,KAAI;YACjB,MAAM,OAAO,GAAG,wBAAwB,CAAC;AACzC,YAAA,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAClC,YAAA,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;AAC1B,YAAA,OAAO,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;AAC/B,SAAC,CAAC,EACF,GAAG,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAC7C,CAAC;QAEF,IAAI,CAAC,OAAO,CAAC,wBAAwB,CAAC,YAAY,CAAC,CAAC,SAAS,EAAE,CAAC;KACjE;IAEM,UAAU,CAAC,QAAgB,EAAE,OAAwB,EAAA;QAC1D,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;AAExC,QAAA,MAAM,KAAK,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC,MAAM,KAAK,MAAM,CAAC,EAAE,IAAI,QAAQ,CAAC,CAAC;AAEnE,QAAA,MAAM,SAAS,GAAW;YACxB,GAAG,OAAO,CAAC,KAAK,CAAC;AACjB,YAAA,GAAG,OAAO;SACX,CAAC;QAEF,MAAM,UAAU,GAAa,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;AAE9C,QAAA,UAAU,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC;AAE9B,QAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAE9B,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA,aAAA,EAAgB,QAAQ,CAAE,CAAA,EAAE,OAAO,CAAC,CAAC,IAAI,CAC5D,UAAU,CAAC,CAAC,GAAG,KAAI;YACjB,MAAM,OAAO,GAAG,uBAAuB,CAAC;AACxC,YAAA,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC;AAC1B,YAAA,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;AAClC,YAAA,OAAO,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;AAC/B,SAAC,CAAC,EACF,WAAW,EAAE,CACd,CAAC;KACH;AAEM,IAAA,gBAAgB,CAAC,QAAgB,EAAA;AACtC,QAAA,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CACvB,GAAG,CAAC,CAAC,OAAO,KACV,OAAO;aACJ,MAAM,CAAC,CAAC,MAAM,KAAK,MAAM,CAAC,QAAQ,IAAI,QAAQ,CAAC;AAC/C,aAAA,IAAI,CAAC,kBAAkB,CAAC,CAC5B,CACF,CAAC;KACH;;6GA/DU,eAAe,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,UAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,cAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,eAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;AAAf,eAAA,CAAA,KAAA,GAAA,EAAA,CAAA,qBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,SAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,eAAe,cAFd,MAAM,EAAA,CAAA,CAAA;4FAEP,eAAe,EAAA,UAAA,EAAA,CAAA;kBAH3B,UAAU;AAAC,YAAA,IAAA,EAAA,CAAA;AACV,oBAAA,UAAU,EAAE,MAAM;AACnB,iBAAA,CAAA;;;MCJY,iBAAiB,CAAA;AAE5B,IAAA,WAAA,GAAA,GAAiB;IAEjB,QAAQ,GAAA;KACP;;+GALU,iBAAiB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;AAAjB,iBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,oBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,SAAA,EAAA,IAAA,EAAA,iBAAiB,EARlB,QAAA,EAAA,eAAA,EAAA,QAAA,EAAA,EAAA,EAAA,QAAA,EAAA,CAAA;;;;AAIT,EAAA,CAAA,EAAA,QAAA,EAAA,IAAA,EAAA,CAAA,CAAA;4FAIU,iBAAiB,EAAA,UAAA,EAAA,CAAA;kBAV7B,SAAS;AACE,YAAA,IAAA,EAAA,CAAA,EAAA,QAAA,EAAA,eAAe,EACf,QAAA,EAAA,CAAA;;;;AAIT,EAAA,CAAA,EAAA,CAAA;;;MCEU,cAAc,CAAA;;4GAAd,cAAc,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,QAAA,EAAA,CAAA,CAAA;AAAd,cAAA,CAAA,IAAA,GAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,SAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,cAAc,iBAJV,iBAAiB,CAAA,EAAA,OAAA,EAAA,CACtB,YAAY,EAAE,gBAAgB,aAC9B,iBAAiB,CAAA,EAAA,CAAA,CAAA;6GAEhB,cAAc,EAAA,OAAA,EAAA,CAHf,YAAY,EAAE,gBAAgB,CAAA,EAAA,CAAA,CAAA;4FAG7B,cAAc,EAAA,UAAA,EAAA,CAAA;kBAL1B,QAAQ;AAAC,YAAA,IAAA,EAAA,CAAA;oBACR,YAAY,EAAE,CAAC,iBAAiB,CAAC;AACjC,oBAAA,OAAO,EAAE,CAAC,YAAY,EAAE,gBAAgB,CAAC;oBACzC,OAAO,EAAE,CAAC,iBAAiB,CAAC;AAC7B,iBAAA,CAAA;;;ACJD,MAAM,SAAS,GAAG,WAAW,CAAC;MAKjB,mBAAmB,CAAA;AAQ9B,IAAA,WAAA,CAAoB,IAAgB,EAAA;QAAhB,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAY;AAP5B,QAAA,IAAA,CAAA,OAAO,GAAG,IAAI,eAAe,CAAc,IAAI,CAAC,CAAC;AAElD,QAAA,IAAA,CAAA,KAAK,GAA4B,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC;QAMlE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;QAE1D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,QAAQ,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;QAExE,MAAM,IAAI,GAAG,YAAY,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AAE7C,QAAA,IAAI,IAAI,EAAE;AACR,YAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;AACrC,SAAA;KACF;IAEM,KAAK,CAAC,KAAa,EAAE,QAAgB,EAAA;QAC1C,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAO,YAAY,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC,IAAI,CACjE,GAAG,CAAC,CAAC,IAAI,KAAI;AACX,YAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACxB,YAAA,YAAY,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;AACxD,SAAC,CAAC,EACF,WAAW,EAAE,CACd,CAAC;KACH;IAEM,MAAM,GAAA;AACX,QAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACxB,QAAA,YAAY,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;KACpC;;iHAjCU,mBAAmB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,UAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;AAAnB,mBAAA,CAAA,KAAA,GAAA,EAAA,CAAA,qBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,SAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,mBAAmB,cAFlB,MAAM,EAAA,CAAA,CAAA;4FAEP,mBAAmB,EAAA,UAAA,EAAA,CAAA;kBAH/B,UAAU;AAAC,YAAA,IAAA,EAAA,CAAA;AACV,oBAAA,UAAU,EAAE,MAAM;AACnB,iBAAA,CAAA;;;ACTD;;AAEG;;ACFH;;AAEG;;;;"}