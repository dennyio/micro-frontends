(self.webpackChunkmf_courses=self.webpackChunkmf_courses||[]).push([[6619],{6619:(M,d,c)=>{c.r(d),c.d(d,{StoreAuthLibService:()=>L,StoreLibComponent:()=>S,StoreLibModule:()=>C,StoreLibService:()=>v,sortCoursesBySeqNo:()=>h});var r=c(8043),n=c(3970),p=c(8475),a=c(2847),b=c(2581);function h(e,i){return e.seqNo-i.seqNo}let v=(()=>{class e{constructor(t,o,s){this.http=t,this.loading=o,this.messages=s,this.subject=new n.BehaviorSubject([]),this.courses$=this.subject.asObservable(),this.loadAllCourses()}loadAllCourses(){const t=this.http.get("/api/courses").pipe((0,n.map)(o=>o.payload),(0,n.catchError)(o=>{const s="Could not load courses";return this.messages.showErrors(s),console.log(s,o),(0,n.throwError)(()=>o)}),(0,n.tap)(o=>this.subject.next(o)));this.loading.showLoaderUntilCompleted(t).subscribe()}saveCourse(t,o){const s=this.subject.getValue(),f=s.findIndex(u=>u.id==t),_={...s[f],...o},g=s.slice(0);return g[f]=_,this.subject.next(g),this.http.put(`/api/courses/${t}`,o).pipe((0,n.catchError)(u=>{const m="Could not save course";return console.log(m,u),this.messages.showErrors(m),(0,n.throwError)(()=>u)}),(0,n.shareReplay)())}filterByCategory(t){return this.courses$.pipe((0,n.map)(o=>o.filter(s=>s.category==t).sort(h)))}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(p.HttpClient),r.\u0275\u0275inject(a.LoadingService),r.\u0275\u0275inject(a.MessagesService))},e.\u0275prov=r.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),S=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.\u0275\u0275defineComponent({type:e,selectors:[["lib-store-lib"]],decls:2,vars:0,template:function(t,o){1&t&&(r.\u0275\u0275elementStart(0,"p"),r.\u0275\u0275text(1," store-lib works! "),r.\u0275\u0275elementEnd())},encapsulation:2}),e})(),C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=r.\u0275\u0275defineInjector({imports:[b.CommonModule,a.CommonsLibModule]}),e})();const l="auth_data";let L=(()=>{class e{constructor(t){this.http=t,this.subject=new n.BehaviorSubject(null),this.user$=this.subject.asObservable(),this.isLoggedIn$=this.user$.pipe((0,n.map)(s=>!!s)),this.isLoggedOut$=this.isLoggedIn$.pipe((0,n.map)(s=>!s));const o=localStorage.getItem(l);o&&this.subject.next(JSON.parse(o))}login(t,o){return this.http.post("/api/login",{email:t,password:o}).pipe((0,n.tap)(s=>{this.subject.next(s),localStorage.setItem(l,JSON.stringify(s))}),(0,n.shareReplay)())}logout(){this.subject.next(null),localStorage.removeItem(l)}}return e.\u0275fac=function(t){return new(t||e)(r.\u0275\u0275inject(p.HttpClient))},e.\u0275prov=r.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);